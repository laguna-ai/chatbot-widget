function formatMessage(e){return e?e=(e=(e=(e=(e=e.replace(/<br\s*\/?>/gi,"___BR___")).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/</g,"&lt;").replace(/>/g,"&gt;")).replace(/___BR___/g,"<br>")).replace(/\n/g,"<br>")).replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\[([^\]]+)\]\((https?:\/\/[^\s)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" style="color:#0066cc; text-decoration:underline;">$1</a>'):""}export function addMessage(e,t,n){const r=formatMessage(e),s=document.createElement("div");s.className="message-enter mb-4";const a=(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});s.innerHTML="user"===t?`\n            <div class="flex justify-end">\n                <div class="bg-secondary-100 p-3 rounded-lg shadow-sm max-w-[85%] border border-primary-200">\n                    <p class="text-primary-900 text-left text-sm">${r}</p>\n                </div>\n            </div>\n            <div class="text-xs text-primary-500 mt-1 text-right">${a}</div>\n        `:`\n            <div class="flex items-start">\n                <div class="w-8 h-8 rounded-full bg-white border border-primary-200 flex items-center justify-center mr-2 text-lg">\n                    <img src="img/12.png" alt="MentIA" class="w-6 h-6">\n                </div>\n                <div class="bg-white p-3 rounded-lg shadow-sm max-w-[85%] border border-primary-100">\n                    <p class="text-primary-900 text-left text-sm">${r}</p>\n                </div>\n            </div>\n            <div class="text-xs text-primary-500 mt-1 pl-10">${a}</div>\n        `,n.appendChild(s),n.scrollTop=n.scrollHeight}export function initWidget(e){if(e.initialMessage){const t=document.querySelector("#chat-messages .message-enter");if(t){const n=t.querySelector("p");n&&(n.textContent=e.initialMessage)}}e.brandName&&document.querySelectorAll(".font-semibold").forEach(t=>{"TuEmpresa"===t.textContent&&(t.textContent=e.brandName)}),e.suggestions&&e.suggestions.length>0&&document.querySelectorAll(".suggestion-btn").forEach((t,n)=>{e.suggestions[n]&&(t.textContent=e.suggestions[n])}),e.primaryColor&&document.documentElement.style.setProperty("--color-primary-500",e.primaryColor),e.secondaryColor&&document.documentElement.style.setProperty("--color-secondary-600",e.secondaryColor)}export function createStreamingMessageElement(e){const t=(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),n=document.createElement("div");return n.className="message-enter mb-4",n.id=e,n.innerHTML=`\n        <div class="flex items-start">\n            <div class="w-8 h-8 rounded-full bg-white border border-primary-200 flex items-center justify-center mr-2 text-lg">\n                <img src="img/12.png" alt="MentIA" class="w-6 h-6">\n            </div>\n            <div class="bg-white p-3 rounded-lg shadow-sm max-w-[85%] border border-primary-100">\n                <p class="text-primary-900 text-left text-sm" id="${e}-content">\n                    <span class="typing-indicator">\n                        <span class="text-primary-600">.</span>\n                        <span class="text-primary-600">.</span>\n                        <span class="text-primary-600">.</span>\n                    </span>\n                </p>\n            </div>\n        </div>\n        <div class="text-xs text-primary-500 mt-1 pl-10">${t}</div>\n    `,n}export function updateMessageElement(e,t){const n=document.getElementById(`${e}-content`);if(n){const e=n.querySelector(".typing-indicator");e&&e.remove(),n.innerHTML+=formatMessage(t)}}export function finalizeMessageElement(e,t){const n=document.getElementById(`${e}-content`);n&&(n.innerHTML=formatMessage(t))}