export function getOrGenerateSessionId(){let e=sessionStorage.getItem("chatbotSessionId");return e||(e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),sessionStorage.setItem("chatbotSessionId",e)),e}export function sendMessageToBotStream(e,t,s,n,o,r,a,i){const x={sessionInfo:{session:`projects/YOUR_PROJECT_ID/locations/us-central1/agents/YOUR_AGENT_ID/sessions/${t}`,parameters:{userName:i}},text:e};n.length>0&&(x.sessionInfo.parameters.context=n),fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)}).then(e=>{if(!e.ok)throw new Error(`API Error: ${e.status}`);const t=e.body.getReader(),s=new TextDecoder;let n="";return t.read().then(function e({done:a,value:i}){if(a)return void r();let x;for(n+=s.decode(i,{stream:!0});-1!==(x=n.indexOf("\n\n"));){const e=n.substring(0,x);if(n=n.substring(x+2),e.startsWith("data: ")){const t=e.replace("data: ","");o(t)}}return t.read().then(e)})}).catch(e=>{a(e)})}const UPDATE_HISTORY_URL="https://aux-funcs.azurewebsites.net/api/update_history?";export function updateHistoryOnBackend(e,t,s){fetch(UPDATE_HISTORY_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:e,history:t,user_name:s})}).then(e=>{e.ok||console.error("Error updating history:",e.status)}).catch(e=>{console.error("Failed to update history:",e)})}