function formatMessage(e){if(!e)return"";return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\[([^\]]+)\]\((https?:\/\/[^\s)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" style="color:#0066cc; text-decoration:underline;">$1</a>')}export function addMessage(e,t,r){const n=formatMessage(e),s=document.createElement("div");s.className="message-enter mb-4";var i,a,o;s.innerHTML=(i="user"===t,a=n,o=(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),i?`<div class="flex justify-end">\n                <div class="bg-primary-100 p-3 rounded-lg shadow-sm max-w-[80%] border border-primary-200">\n                    <p class="text-primary-900 text-left">${a}</p>\n                </div>\n            </div>\n            <div class="text-xs text-primary-500 mt-1 text-right">${o}</div>`:`<div class="flex items-start">\n                <div class="w-8 h-8 rounded-full bg-white border border-primary-200 flex items-center justify-center mr-2 text-lg">\n                    <img src="img/12.png" alt="MentIA" class="w-6 h-6">\n                </div>\n                <div class="bg-white p-3 rounded-lg shadow-sm max-w-[80%] border border-primary-100">\n                    <p class="text-primary-900 text-left">${a}</p>\n                </div>\n            </div>\n            <div class="text-xs text-primary-500 mt-1 pl-10">${o}</div>`),r.appendChild(s),r.scrollTop=r.scrollHeight}export function showTypingIndicator(e,t){e.classList.remove("hidden"),t.scrollTop=t.scrollHeight}export function hideTypingIndicator(e){e.classList.add("hidden")}export function initWidget(e){if(e.initialMessage){const t=document.querySelector("#chat-messages .message-enter");t&&(t.querySelector("p").textContent=e.initialMessage)}if(e.brandName){document.querySelectorAll(".font-semibold").forEach(t=>{"TuEmpresa"===t.textContent&&(t.textContent=e.brandName)})}if(e.suggestions&&e.suggestions.length>0){document.querySelectorAll(".suggestion-btn").forEach((t,r)=>{e.suggestions[r]&&(t.textContent=e.suggestions[r])})}e.primaryColor&&document.documentElement.style.setProperty("--color-primary-500",e.primaryColor),e.secondaryColor&&document.documentElement.style.setProperty("--color-secondary-600",e.secondaryColor)}export function createStreamingMessageElement(e){const t=(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),r=document.createElement("div");return r.className="message-enter mb-4",r.id=e,r.innerHTML=`\n        <div class="flex items-start">\n            <div class="w-8 h-8 rounded-full bg-white border border-primary-200 flex items-center justify-center mr-2 text-lg">\n                <img src="img/12.png" alt="MentIA" class="w-6 h-6">\n            </div>\n            <div class="bg-white p-3 rounded-lg shadow-sm max-w-[80%] border border-primary-100">\n                <p class="text-primary-900 text-left" id="${e}-content">\n                    <span class="typing-indicator">\n                        <span class="text-primary-600">.</span>\n                        <span class="text-primary-600">.</span>\n                        <span class="text-primary-600">.</span>\n                    </span>\n                </p>\n            </div>\n        </div>\n        <div class="text-xs text-primary-500 mt-1 pl-10">${t}</div>\n    `,r}export function updateMessageElement(e,t){const r=document.getElementById(`${e}-content`);if(r){const e=r.querySelector(".typing-indicator");e&&e.remove(),r.innerHTML+=formatMessage(t)}}export function finalizeMessageElement(e,t){const r=document.getElementById(`${e}-content`);r&&(r.innerHTML=formatMessage(t))}